<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <title>Architecture - Fetch.ai Developer Documentation</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="Everything you need to know about Fetch.ai.">
  <meta name="generator" content="mkdocs-1.0.4, mkdocs-">
  <meta name="author" content="katharine.murphy@fetch.ai">
  <link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

  <meta name="HandheldFriendly" content="true"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta rel="next" href="" />
  <script type="text/javascript" src="//code.jquery.com/jquery-1.9.1.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script>var base_url = '../..';</script>
  <link href="../../css/style.min.css" rel="stylesheet">
    <link href="../../css/my-styles.css" rel="stylesheet"> 
</head>

<body>
  <div id="page-container">
    <div id="content-wrap">

        <div id="mkdocs-search-wrapper">
          <button id="closeSearchResults">&times;</button>
          <div id="mkdocs-search-results" class="search-popup">
            Sorry, page not found.
          </div><!-- #mkdocs-search-results end -->
        </div><!-- #mkdocs-search-wrapper end -->

      <div class="header-wrap">
        <div class="menuheader">
          <div class="headerlogo">
            <a href="https://fetch.ai" target="_blank">
              <img src="../../assets/images/logo.png" alt="Fetch Logo">
            </a>
          </div><!-- .headerlogo end -->

          <ul class="menu">
            <li><a href="https://developer.fetch.ai/bounties">Bounty </a></li>
            <li><a href="https://blockexplorer-alpha.fetch-ai.com/">Explorer </a></li>
            <li><a href="http://build.fetch.ai">Build</a></li>
            <li><a href="http://developer.fetch.ai/#links">Links </a></li>
            <li><a href="https://docs.fetch.ai/tutorials/">Tutorials </a></li>

          </ul><!-- .menu end -->
        </div><!-- .menuheader end -->
      </div><!-- .header-wrap end -->

      <div class="book">
            <div id="book-search-input" role="search">
              <form action="search.html" id="searchForm">
                <input name="q" id="mkdocs-search-query" type="text" placeholder="Type to search">
              </form>
            </div> <!-- #book-search-input end -->
	
        <div class="book-summary not-loaded">

            <nav role="navigation" id="nav">
    <ul class="summary" id="summary"> 
<li>
    <a href="/" id="-"
        >Home</a
    >
</li>
 
<li>
    <span class="head">Getting Started</span>
    <ul id="header_getting_started"> 
<li>
    <a href="../../getting-started/quickstart/" id="getting-started-quickstart-"
        >QuickStart</a
    >
</li>
 
<li>
    <a href="../../getting-started/versions/" id="getting-started-versions-"
        >Versions</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Ledger</span>
    <ul id="header_ledger"> 
<li>
    <a href="../" id="ledger-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="./" id="ledger-architecture-"
        >Architecture</a
    >
</li>
 
<li>
    <span class="head">Usage</span>
    <ul id="header_usage"> 
<li>
    <span class="head">Installation</span>
    <ul id="header_installation"> 
<li>
    <a href="../../getting-started/installation-mac/" id="getting-started-installation-mac-"
        >MacOS</a
    >
</li>
 
<li>
    <a href="../../getting-started/installation-ubuntu/" id="getting-started-installation-ubuntu-"
        >Ubuntu</a
    >
</li>
 
<li>
    <a href="../../getting-started/installation-redhat/" id="getting-started-installation-redhat-"
        >Redhat</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../running-a-constellation/" id="ledger-running-a-constellation-"
        >Running a node</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Maths and ML</span>
    <ul id="header_maths_and_ml"> 
<li>
    <a href="../maths-lib-overview/" id="ledger-maths-lib-overview-"
        >Maths library introduction</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Python API</span>
    <ul id="header_python_api"> 
<li>
    <a href="../../getting-started/python-api-install/" id="getting-started-python-api-install-"
        >Installation</a
    >
</li>
 
<li>
    <span class="head">Examples</span>
    <ul id="header_examples"> 
<li>
    <a href="../python-ledger-api/examples/block-number/" id="ledger-python-ledger-api-examples-block-number-"
        >Block Number</a
    >
</li>

    </ul>
</li>
    </ul>
</li>
    </ul>
</li> 
<li>
    <span class="head">Agent Framework</span>
    <ul id="header_agent_framework"> 
<li>
    <a href="../../aea/" id="aea-"
        >Welcome</a
    >
</li>
 
<li>
    <a href="../../aea/quickstart/" id="aea-quickstart-"
        >AEA quick start</a
    >
</li>
 
<li>
    <span class="head">The AEA universe</span>
    <ul id="header_the_aea_universe"> 
<li>
    <a href="../../aea/vision/" id="aea-vision-"
        >Vision</a
    >
</li>
 
<li>
    <a href="../../aea/app-areas/" id="aea-app-areas-"
        >Application areas</a
    >
</li>
 
<li>
    <a href="../../aea/trust/" id="aea-trust-"
        >Trust issues</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Demos</span>
    <ul id="header_demos"> 
<li>
    <a href="../../aea/gym-plugin/" id="aea-gym-plugin-"
        >Gym demo</a
    >
</li>
 
<li>
    <a href="../../aea/gym-skill/" id="aea-gym-skill-"
        >Gym skill</a
    >
</li>
 
<li>
    <a href="../../aea/weather-skills/" id="aea-weather-skills-"
        >Weather skills</a
    >
</li>
 
<li>
    <a href="../../aea/tac/" id="aea-tac-"
        >TAC external app</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Architecture</span>
    <ul id="header_architecture"> 
<li>
    <a href="../../aea/design-principles/" id="aea-design-principles-"
        >Design principles</a
    >
</li>
 
<li>
    <a href="../../aea/diagram/" id="aea-diagram-"
        >Architectural diagram</a
    >
</li>
 
<li>
    <a href="../../aea/core-components/" id="aea-core-components-"
        >Core components</a
    >
</li>
 
<li>
    <a href="../../aea/file-structure/" id="aea-file-structure-"
        >File structure</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Developer guide</span>
    <ul id="header_developer_guide"> 
<li>
    <a href="../../aea/steps/" id="aea-steps-"
        >Step by step</a
    >
</li>
 
<li>
    <a href="../../aea/skill/" id="aea-skill-"
        >Skill</a
    >
</li>
 
<li>
    <a href="../../aea/skill-guide/" id="aea-skill-guide-"
        >Build your own skill</a
    >
</li>
 
<li>
    <a href="../../aea/protocol/" id="aea-protocol-"
        >Protocol</a
    >
</li>
 
<li>
    <a href="../../aea/connection/" id="aea-connection-"
        >Connection</a
    >
</li>
 
<li>
    <a href="../../aea/scaffolding/" id="aea-scaffolding-"
        >Scaffolding</a
    >
</li>
 
<li>
    <a href="../../aea/logging/" id="aea-logging-"
        >Logging</a
    >
</li>
 
<li>
    <span class="head">CLI</span>
    <ul id="header_cli"> 
<li>
    <a href="../../aea/cli-how-to/" id="aea-cli-how-to-"
        >CLI tool</a
    >
</li>
 
<li>
    <a href="../../aea/cli-commands/" id="aea-cli-commands-"
        >Commands</a
    >
</li>
 
<li>
    <a href="../../aea/cli-gui/" id="aea-cli-gui-"
        >GUI</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../../aea/hacking-an-agent/" id="aea-hacking-an-agent-"
        >Create an agent programmatically</a
    >
</li>
 
<li>
    <a href="../../aea/integration/" id="aea-integration-"
        >Integrate with third parties</a
    >
</li>

    </ul>
</li>
    </ul>
</li> 
<li>
    <span class="head">Machine Learning</span>
    <ul id="header_machine_learning"> 
<li>
    <a href="../../machine-learning/" id="machine-learning-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="../../machine-learning/library-architecture/" id="machine-learning-library-architecture-"
        >Library architecture</a
    >
</li>
 
<li>
    <a href="../../machine-learning/smart-contract-example/" id="machine-learning-smart-contract-example-"
        >AI in smart contracts</a
    >
</li>
 
<li>
    <a href="../../machine-learning/synergetic-contract-example/" id="machine-learning-synergetic-contract-example-"
        >AI in synergetic contracts</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Etch Language</span>
    <ul id="header_etch_language"> 
<li>
    <span class="head">Welcome</span>
    <ul id="header_welcome"> 
<li>
    <a href="../../etch-language/" id="etch-language-"
        >What's etch?</a
    >
</li>
 
<li>
    <a href="../../etch-language/getstarted/" id="etch-language-getstarted-"
        >Getting started</a
    >
</li>
 
<li>
    <a href="../../etch-language/debug/" id="etch-language-debug-"
        >Debugging</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">The Basics</span>
    <ul id="header_the_basics"> 
<li>
    <a href="../../etch-language/syntax/" id="etch-language-syntax-"
        >Syntax</a
    >
</li>
 
<li>
    <a href="../../etch-language/variables/" id="etch-language-variables-"
        >Variables</a
    >
</li>
 
<li>
    <a href="../../etch-language/operators/" id="etch-language-operators-"
        >Operators</a
    >
</li>
 
<li>
    <a href="../../etch-language/logic/" id="etch-language-logic-"
        >Logical operators</a
    >
</li>
 
<li>
    <a href="../../etch-language/control-flow/" id="etch-language-control-flow-"
        >Control flow</a
    >
</li>
 
<li>
    <a href="../../etch-language/strings/" id="etch-language-strings-"
        >Strings</a
    >
</li>
 
<li>
    <a href="../../etch-language/arrays/" id="etch-language-arrays-"
        >Arrays</a
    >
</li>
 
<li>
    <a href="../../etch-language/functions/" id="etch-language-functions-"
        >Functions</a
    >
</li>
 
<li>
    <span class="head">Function Annotations</span>
    <ul id="header_function_annotations"> 
<li>
    <a href="../../etch-language/sc-annotations/" id="etch-language-sc-annotations-"
        >Smart contract annotations</a
    >
</li>
 
<li>
    <a href="../../etch-language/syn-annotations/" id="etch-language-syn-annotations-"
        >Synergetic contract annotations</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../../etch-language/error-checking/" id="etch-language-error-checking-"
        >Error checking</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Fetch Ledger Types</span>
    <ul id="header_fetch_ledger_types"> 
<li>
    <a href="../../etch-language/persistent-globals/" id="etch-language-persistent-globals-"
        >Persistent globals</a
    >
</li>
 
<li>
    <a href="../../etch-language/states/" id="etch-language-states-"
        >State</a
    >
</li>
 
<li>
    <a href="../../etch-language/sharded-state/" id="etch-language-sharded-state-"
        >ShardedState</a
    >
</li>
 
<li>
    <a href="../../etch-language/addresses/" id="etch-language-addresses-"
        >Address</a
    >
</li>
 
<li>
    <a href="../../etch-language/crypto/" id="etch-language-crypto-"
        >Cryptographic functions</a
    >
</li>
 
<li>
    <a href="../../etch-language/context/" id="etch-language-context-"
        >Context</a
    >
</li>
 
<li>
    <a href="../../etch-language/transaction/" id="etch-language-transaction-"
        >Transaction</a
    >
</li>
 
<li>
    <a href="../../etch-language/balance-transfer/" id="etch-language-balance-transfer-"
        >Balance and Transfer</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Mathematics</span>
    <ul id="header_mathematics"> 
<li>
    <a href="../../etch-language/maths-functions/" id="etch-language-maths-functions-"
        >Maths functions</a
    >
</li>
 
<li>
    <a href="../../etch-language/tensor/" id="etch-language-tensor-"
        >Tensor</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Machine Learning</span>
    <ul id="header_machine_learning"> 
<li>
    <a href="../../etch-language/model/" id="etch-language-model-"
        >Model</a
    >
</li>
 
<li>
    <a href="../../etch-language/graph/" id="etch-language-graph-"
        >Graph</a
    >
</li>
 
<li>
    <a href="../../etch-language/data-loaders/" id="etch-language-data-loaders-"
        >DataLoader</a
    >
</li>
 
<li>
    <a href="../../etch-language/optimiser/" id="etch-language-optimiser-"
        >Optimiser</a
    >
</li>
 
<li>
    <a href="../../etch-language/scaler/" id="etch-language-scaler-"
        >Scaler</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Extending Etch</span>
    <ul id="header_extending_etch"> 
<li>
    <a href="../../etch-language/extending-etch/" id="etch-language-extending-etch-"
        >Extending etch in C++</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Examples</span>
    <ul id="header_examples"> 
<li>
    <a href="../../etch-language/examples/fetch-logo/" id="etch-language-examples-fetch-logo-"
        >Fetch logo</a
    >
</li>
 
<li>
    <a href="../../etch-language/examples/mandelbrot/" id="etch-language-examples-mandelbrot-"
        >Mandelbrot</a
    >
</li>
 
<li>
    <a href="../../etch-language/examples/searching-algorithms/" id="etch-language-examples-searching-algorithms-"
        >Searching algorithms</a
    >
</li>
 
<li>
    <a href="../../etch-language/examples/sorting-algorithms/" id="etch-language-examples-sorting-algorithms-"
        >Sorting algorithms</a
    >
</li>
 
<li>
    <a href="../../etch-language/examples/dft/" id="etch-language-examples-dft-"
        >Discrete Fourier Transformation</a
    >
</li>

    </ul>
</li>
    </ul>
</li> 
<li>
    <span class="head">Smart Contracts</span>
    <ul id="header_smart_contracts"> 
<li>
    <a href="../../smart-contracts/smart-contract-intro/" id="smart-contracts-smart-contract-intro-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/static-dynamic/" id="smart-contracts-static-dynamic-"
        >Static and dynamic contracts</a
    >
</li>
 
<li>
    <span class="head">Fetch.ai smart contracts</span>
    <ul id="header_fetch.ai_smart_contracts"> 
<li>
    <a href="../../smart-contracts/etch-smart-contracts/" id="smart-contracts-etch-smart-contracts-"
        >Smart contracts in Etch</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/pipenv/" id="smart-contracts-pipenv-"
        >Development environment</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/executing-smart-contract-code/" id="smart-contracts-executing-smart-contract-code-"
        >Executing smart contracts</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Synergetic contracts</span>
    <ul id="header_synergetic_contracts"> 
<li>
    <a href="../../smart-contracts/synergetic/" id="smart-contracts-synergetic-"
        >Synergetic contracts</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/executing-synergetic-code/" id="smart-contracts-executing-synergetic-code-"
        >Executing synergetic contracts</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../../smart-contracts/memory/" id="smart-contracts-memory-"
        >Memory</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/fees/" id="smart-contracts-fees-"
        >Fees</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/wallets/" id="smart-contracts-wallets-"
        >Wallets</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Tutorials</span>
    <ul id="header_tutorials"> 
<li>
    <a href="../../tutorials/fet1/" id="tutorials-fet1-"
        >Create FET-1 contract</a
    >
</li>
 
<li>
    <a href="https://www.youtube.com/watch?v=mwkAUh-_uxA&list=PL09jEkqdEp94oV7XYsHvfvHwMTBC0QfwJ" id="https:--www.youtube.com-watch?v=mwkAUh-_uxA&list=PL09jEkqdEp94oV7XYsHvfvHwMTBC0QfwJ"
        >Videos</a
    >
</li>

    </ul>
</li> 
    </ul>
</nav>

        </div> <!-- .book-summary end -->

        <div class="book-body" >
          <div class="body-inner" id="book-body">

            <div class="page-wrapper" tabindex="-1" role="main">
              <div class="page-inner" id="book-body-inner">

                <section class="normal markdown-section p17">

                  

<h1 id="architecture">Architecture</h1>
<p>This section describes at a high level how the Fetch.ai ledger operates; for full understanding of the ledger architecture please read <a href="https://fetch.ai/wp-content/uploads/2019/10/Fetch.AI-Ledger-Yellow-Paper.pdf">the yellow paper</a>. We assume the reader is comfortable with concepts that underpin blockchain technology such as public key cryptography, consensus and smart contracts.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is work in progress.</p>
</div>
<p>The following diagram gives a high level overview of the components a node consists of. The entry point is the <strong>Constellation</strong> application; every time a node is deployed in the network, an instance of this application is created. Please read <a href="../running-a-constellation/">this section</a> for more information about how to run a node.</p>
<p><img alt="Fetch.ai Ledger architecture high level view" src="../img/architecture.png" /></p>
<p>The <strong>block coordinator</strong> inside each node is responsible for adding new blocks to its copy of the chain, while preserving its consistency. In order to do so, it advances along the chain to find the longest/heaviest branch, and drops the ones that are not. After reaching the heaviest block, the block coordinator asks the executor(s) and consensus for help to add a new block, which contains a set of transactions.</p>
<p><strong>Consensus</strong> is responsible for building a block that will be considered correct, e.g. with a timestamp greater than that of the heaviest block in the chain.</p>
<p>The <strong>executor</strong> takes said block, iterates through all the transactions packed within it, and for each of them:</p>
<ol>
<li>It determines if the transaction is valid, has paid the required fees, etc.</li>
<li>Since conceptually a transaction is a state change in blockchain, it updates the state accordingly.</li>
</ol>
<p>Blocks are then exchanged between nodes via a <strong>block synchronization protocol</strong>. Consensus is also responsible for verifying that blocks received this way are correct.</p>
<h2 id="sharding">Sharding</h2>
<p>In order to prevent attacks such as <a href="https://en.wikipedia.org/wiki/Double-spending">double spending</a>, transactions in a blockchain are executed in a strict, sequential order, thus ensuring that access to any given resource is strictly sequential. On a traditional decentralized ledger, this ordering of transactions must be identical across all the nodes that replicate the process.</p>
<p>The Fetch.ai ledger relaxes the requirement on sequential execution by partitioning resources into mutually disjoint subsets called <strong>resource groups</strong>. Transactions that affect resources from different groups are then handled by separate <strong>resource lanes</strong>. The ledger defines a complete ordering of transactions belonging to a given lane, but not across lanes. A strict temporal ordering of transactions, including simultaneous execution of non-conflicting events, is achieved by entering transactions into a novel block structure.</p>
<p>In order to understand better how resources lanes work, let's take a look at the following example:</p>
<p><img alt="Example of sharding with parallel lanes" src="../img/sharding-lanes.png" /></p>
<p>Dashed horizontal lines represent resource lanes. Vertical cyan bars denote transactions that involve resources (magenta circles) from one or more lanes. Groups of compatible transactions are arranged into block slices, demarcated by vertical lines, and can be executed simultaneously. For example, in the first block slice, the transaction involving resource groups 1 and 2 can be executed at the same time as the transaction that involves groups 3 and 5. This feature allows the ledger to scale its throughput to accommodate an arbitrary number of transactions.</p>
<p>The bold vertical lines represent the putative boundaries of blocks that are to be entered into the blockchain. Each block contains a fixed number of slices, which we refer to as the slice number. The lane number, which specifies the other dimension of the block undergoes a doubling after the boundary of the second block, leading to a concomitant doubling of the transaction throughput. As a consequence of this design, the size of a block can vary by increasing or decreasing the number of shards. This allows the network to balance block sizes against economic incentives, for example.</p>
<p>This blockchain sharding design speeds up the network as contracts can execute concurrently, providing a solution to the blockchain scalability problem. Furthermore, resource lanes serve a similar purpose as sharding in conventional databases, and reduce the minimum storage requirements on the smallest processing node on the network. The number of lanes can also be adjusted according to the transaction load.</p>
<h2 id="http-pages-and-api">HTTP pages and API</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Coming soon</p>
</div>
<h2 id="networking">Networking</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Coming soon</p>
</div>
<p><br/></p>


                </section>

              </div> <!-- .page-inner end -->

              <div class="bottomnav">
                
                <a href="../" class="button left"><strong>Previous:</strong></br>Introduction</a>
                
                <a href="../../getting-started/installation-mac/" class="button right"><strong>Next:</strong></br>Macos</a>
              </div><!-- .bottomnav end -->

            </div> <!-- .page-wrapper end -->

          </div> <!-- .body-inner end -->
        </div> <!-- .book-body end -->

      </div><!-- .book end -->
    </div><!-- #content-wrap -->

    <footer>
      <div class="lower-footer">
        <div class="col-1">
          <div class="social">
            <a href="https://t.me/fetch_ai" target="_blank"><i class="fab fa-telegram-plane" aria-hidden="true"></i></a>
            <a href="https://twitter.com/fetch_ai?lang=en" target="_blank"><i class="fab fa-twitter" aria-hidden="true"></i></a>
            <a href="https://www.linkedin.com/company/fetch-ai/" target="_blank"><i class="fab fa-linkedin" aria-hidden="true"></i></a>
            <a href="https://www.youtube.com/c/FetchAI" target="_blank"><i class="fab fa-youtube" aria-hidden="true"></i></a>
            <a href="https://medium.com/fetch-ai" target="_blank"><i class="fab fa-medium-m" aria-hidden="true"></i></a>
            <a href="https://github.com/fetchai" target="_blank"><i class="fab fa-github" aria-hidden="true"></i></a>
          </div>
        </div>
        <div class="col-2">Copyright © <a href="https://fetch.ai">Fetch.ai</a> <span class="year">2019</span></div>
      </div>
    </footer>
  </div><!-- end #page-container -->

  <link rel="stylesheet" id="font-awesome-css" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" type="text/css" media="all">
  <script src="../../js/main.js"></script>
      <script src="../../js/menu.js"></script>
      <script src="../../search/main.js"></script>
</body>

</html>